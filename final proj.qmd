---
title: "FinalProjRBootcamp"
author: "Caroline Ponticelli"
format: html
editor: visual
execute: 
  cache: true
  echo: false
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
library(gtsummary)
library(tidyverse)
library(here)
library(scales)
library(readr)
library(dplyr)
library(readxl)
library(renv)
library(lubridate)


adopt <- read_excel(here::here("Finalproj", "data", "shelterreportdata.xlsx"))
```

Only data for dogs and certain variables.

```{r}
columns_to_drop <- c(6, 8, 10, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35)

# Drop the specified columns to make a data set with just dog data
adopt_subset <- adopt[, -columns_to_drop]

```

make months into years

```{r}
adopt_subset <- mutate(adopt_subset, YEAR = year(ymd(`Report Period Start`)))

columns_to_dropp <- c(1, 2, 3)

adopt_subset2 <- adopt_subset[, -columns_to_dropp]

```

I only want the shelters that have complete reports. meaning all 37 months they have data
```{r}
shelter_counts <- adopt_subset2 %>%
  group_by(`Shelter Name`) %>%
  summarize(count = n())

shelters_to_keep <- shelter_counts %>%
  filter(count == 37) %>%
  pull(`Shelter Name`)

completeadopt <- adopt_subset2 %>%
  filter(`Shelter Name` %in% shelters_to_keep)

```

Table 1 coding
```{r}
table1<- tbl_summary(
  completeadopt,
  by = 'Shelter Name',
  include= c('Shelter Name', starts_with('Canine'), YEAR)) |>
	 add_overall(col_label = "**Total**")
	


table1
```

```{r}
 
```

```{r}
#| table1: tbl-one
#| tbl-cap: "Table 1: Dog Shelter Statistics"
table1
```

The majority of dogs at the shelter are there because of Owner Surrender with `r inline_text(table1, column = "Owner Sur")` dogs.

The majority of dogs in the shelter were of medium size, `r inline_text(table1, row = "Pet Size" level = "MED"` medium dogs.

The reporting periods were originally by month over ~3 years. Now it is just counts for the different shelters by year.

```{r}



```


```{r}

```
