---
title: "FinalProjRBootcamp"
author: "Caroline Ponticelli"
format: html
editor: visual
execute: 
  cache: true
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
library(gtsummary)
library(tidyverse)
library(here)
library(scales)
library(readr)
library(dplyr)
library(readxl)
library(renv)
install.packages('lubridate')
library(lubridate)


adopt <- read_excel(here::here("Finalproj", "data", "shelterreportdata.xlsx"))
```

Only data for dogs and certain variables. 
```{r}
str(adopt)

columns_to_drop <- c(6, 8, 10, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35)

# Drop the specified columns to make a data set with just dog data
adopt_subset <- adopt[, -columns_to_drop]

```

make months into years
```{r}
adopt_subset <- mutate(adopt_subset, YEAR = year(ymd(`Report Period Start`)))

columns_to_dropp <- c(1, 2, 3)

adopt_subset2 <- adopt_subset[, -columns_to_dropp]

```

Table 1 coding
```{r}
table1<- tbl_summary(
  adopt_subset,
  by = 'Shelter Name',
  missing_text = "missing")
  

 print(table1)
 
table1<- tbl_summary(
  adopt_subset,
  by = 'Shelter Name',
  include = c('Pet Age', Breed, 'Pet Size', Sex,
  ),
			statistic = list(Breed ~ "10% = {p10}; 90% = {p90}",
														Sex ~ "min =  {min}; max = {max}",
														 sleep_wknd ~ "min =  {min}; max = {max}"),
						digits = list(income ~ c(3, 3),
													sleep_wkdy~ c(1, 1),
													sleep_wknd~ c(1, 1)),
						missing_text = "Missing")|>
	add_p(test = list(all_continuous() ~ "t.test", #add p value and tells R how you want them. Change the test you want in quotes
										all_categorical() ~ "chisq.test")) |>

	add_overall(col_label = "**Total**") |>
	bold_labels() |>

	modify_table_styling(
		columns = label, rows = label == "Race/ethnicity",
		footnote = " see https://www.nlsinfo.org/content/cohorts/nlsy79/topical-guide/household/race-ethnicity-immigration-data"
	)
```

```{r}
#| tabel: tbl-one
#| tbl-cap: "Dog Shelter Summary Statistics"
table1
```
The majority of dogs at the shelter are there because of Owner Surrender with `r inline_text(table1, column = "Owner Sur")` dogs. 

The majority of dogs in the shelter were of medium size, `r inline_text(table1, row = "Pet Size" level = "MED"` medium dogs. 

The reporting periods were originally by month over ~3 years. Now it is just counts for the different shelters by year. 

```{r}
table1<- tbl_summary(
  dog_data,
  by = 'Intake Type',
  include = c('Pet Age', Breed, 'Pet Size', Sex,
  )) |>
add_p(test = list(all_continuous() ~ "t.test", 
                    all_categorical() ~ "chisq.test")) |> 
  add_overall(col_label = "**Total**") |> 
  bold_labels() |> 
  modify_footnote(update = everything() ~ NA) |> 
  modify_header(label = "**Variable**", p.value = "**P**")



```

Creating a categorical variable for Pet Age
```{r}

if (dog_data$`Pet Age` == startsWith("1 YEAR")) {dog_data$`Pet Age` = "1-2"}

	table(adopt$"Pet Age")
	
if ('Pet Age' == ("1 YEAR")) {"Age" = "1-2"}
	else if ('Pet Age' == "1 YEAR 1 MONTH") {"Age" = "1-2"}
	else if ('Pet Age' == "1 YEAR 2 MONTH") {"Age" = "1-2"} 
	else if ('Pet Age' == "1 YEAR 2 MONTH") {"Age" = "1-2"}
	else if ('Pet Age' == "1 YEAR 3 MONTH") {"Age" = "1-2"}
	else if ('Pet Age' == "1 YEAR 4 MONTH") {"Age" = "1-2"}
	else if ('Pet Age' == "1 YEAR 9 MONTH") {"Age" = "1-2"} 

emo::ji("dog")
```
